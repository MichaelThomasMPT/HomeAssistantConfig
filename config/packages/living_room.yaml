automation: 
  - alias: Living Room - Notify Me If Dog Door Is Used
    id: living_room_notify_me_if_dog_door_is_used
    trigger:
      - platform: state
        entity_id: binary_sensor.dog_door
        from: 'off'
        to: 'on'
    action:
      - service: notify.mobile_app_michael_s_galaxy_s10
        data:
          message: The dog door was used!
          data:
            group: Dog Door
            tag: dog_door
            color: 'green'
            ttl: 0
      - delay:
          minutes: 1

  - alias: Living Room - Turn On Flood Lights If Dog Door Is Used
    id: living_room_turn_on_flood_lights_if_dog_door_is_used
    trigger:
      - platform: state
        entity_id: binary_sensor.dog_door
        from: 'off'
        to: 'on'
    condition:
      - condition: state #from sunset until sunrise
        entity_id: sun.sun
        state: "below_horizon"
    action:
      - service: scene.create
        data:
          scene_id: flood_lights_state
          snapshot_entities: light.garden_flood_lights
      - service: light.turn_on
        target:
          entity_id: light.garden_flood_lights
      - delay:
          minutes: 1
      - service: scene.turn_on
        target:
          entity_id: scene.flood_lights_state

script:
  turn_off_living_room_tv:
    sequence:
      - condition: state
        entity_id: binary_sensor.living_room_tv
        state:  "on"
      - service: remote.send_command
        target:
          entity_id: remote.broadlink_rm_pro_roomba_remote
        data:
          command: b64:JgBQAAABKJMSEhISEjcSEhISEhISEhISEjcSNxISEjcSNxI3EjcSNxISEhISEhI3EhISEhISEhISNxI3EjcSEhI3EjcSNxI3EgAFGgABKEoSAAxWDQUAAAAAAAA=
  turn_on_living_room_tv:
    sequence:
      - condition: state
        entity_id: binary_sensor.living_room_tv
        state:  "off"
      - service: remote.send_command
        target:
          entity_id: remote.broadlink_rm_pro_roomba_remote
        data:
          command: b64:JgBQAAABKJMSEhISEjcSEhISEhISEhISEjcSNxISEjcSNxI3EjcSNxISEhISEhI3EhISEhISEhISNxI3EjcSEhI3EjcSNxI3EgAFGgABKEoSAAxWDQUAAAAAAAA=

binary_sensor:
  - platform: template
    sensors:
      living_room_tv:
        friendly_name: "Living Room TV"
        value_template: "{{ states('sensor.living_room_tv_power')|float > 10 }}"
        icon_template: >-
          {% if is_state("binary_sensor.living_room_tv", "on") %}
            mdi:television
          {% else %}
            mdi:television-off
          {% endif %}

switch:
  - platform: template
    switches:
      living_room_tv:
        friendly_name: Living Room TV
        value_template: "{{ is_state('binary_sensor.living_room_tv', 'on') }}"
        turn_on:
          service: script.turn_on_living_room_tv
        turn_off:
          service: script.turn_off_living_room_tv
        icon_template: >-
          {% if is_state("binary_sensor.living_room_tv", "on") %} 
            mdi:television
          {% else %}
            mdi:television-off
          {% endif %}